<button type="button" class="navbar-toggle menu-toggler pull-left" id="menu-toggler" data-target="#sidebar">
    <span class="sr-only">Toggle sidebar</span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
</button>

<div class="navbar-header pull-left">
    <a href="index.html" class="navbar-brand">
        <small>
            <i class="fa fa-leaf"></i>
            星光钱包--运营管理平台
        </small>
    </a>
</div>

<div class="navbar-buttons navbar-header pull-right" role="navigation">
    <ul class="nav ace-nav">
        <#--<li class="grey dropdown-modal">
            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                <i class="ace-icon fa fa-tasks"></i>
                <span class="badge badge-grey">4</span>
            </a>

            <ul class="dropdown-menu-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close">
                <li class="dropdown-header">
                    <i class="ace-icon fa fa-check"></i>
                    4 Tasks to complete
                </li>

                <li class="dropdown-content">
                    <ul class="dropdown-menu dropdown-navbar">
                        <li>
                            <a href="#">
                                <div class="clearfix">
                                    <span class="pull-left">Software Update</span>
                                    <span class="pull-right">65%</span>
                                </div>

                                <div class="progress progress-mini">
                                    <div style="width:65%" class="progress-bar"></div>
                                </div>
                            </a>
                        </li>

                        <li>
                            <a href="#">
                                <div class="clearfix">
                                    <span class="pull-left">Hardware Upgrade</span>
                                    <span class="pull-right">35%</span>
                                </div>

                                <div class="progress progress-mini">
                                    <div style="width:35%" class="progress-bar progress-bar-danger"></div>
                                </div>
                            </a>
                        </li>

                        <li>
                            <a href="#">
                                <div class="clearfix">
                                    <span class="pull-left">Unit Testing</span>
                                    <span class="pull-right">15%</span>
                                </div>

                                <div class="progress progress-mini">
                                    <div style="width:15%" class="progress-bar progress-bar-warning"></div>
                                </div>
                            </a>
                        </li>

                        <li>
                            <a href="#">
                                <div class="clearfix">
                                    <span class="pull-left">Bug Fixes</span>
                                    <span class="pull-right">90%</span>
                                </div>

                                <div class="progress progress-mini progress-striped active">
                                    <div style="width:90%" class="progress-bar progress-bar-success"></div>
                                </div>
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="dropdown-footer">
                    <a href="#">
                        See tasks with details
                        <i class="ace-icon fa fa-arrow-right"></i>
                    </a>
                </li>
            </ul>
        </li>-->

        <#--<li class="purple dropdown-modal">
            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                <i class="ace-icon fa fa-bell icon-animated-bell"></i>
                <span class="badge badge-important">8</span>
            </a>

            <ul class="dropdown-menu-right dropdown-navbar navbar-pink dropdown-menu dropdown-caret dropdown-close">
                <li class="dropdown-header">
                    <i class="ace-icon fa fa-exclamation-triangle"></i>
                    8 Notifications
                </li>

                <li class="dropdown-content">
                    <ul class="dropdown-menu dropdown-navbar navbar-pink">
                        <li>
                            <a href="#">
                                <div class="clearfix">
                                                        <span class="pull-left">
                                                            <i class="btn btn-xs no-hover btn-pink fa fa-comment"></i>
                                                            New Comments
                                                        </span>
                                    <span class="pull-right badge badge-info">+12</span>
                                </div>
                            </a>
                        </li>

                        <li>
                            <a href="#">
                                <i class="btn btn-xs btn-primary fa fa-user"></i>
                                Bob just signed up as an editor ...
                            </a>
                        </li>

                        <li>
                            <a href="#">
                                <div class="clearfix">
                                                        <span class="pull-left">
                                                            <i class="btn btn-xs no-hover btn-success fa fa-shopping-cart"></i>
                                                            New Orders
                                                        </span>
                                    <span class="pull-right badge badge-success">+8</span>
                                </div>
                            </a>
                        </li>

                        <li>
                            <a href="#">
                                <div class="clearfix">
                                                        <span class="pull-left">
                                                            <i class="btn btn-xs no-hover btn-info fa fa-twitter"></i>
                                                            Followers
                                                        </span>
                                    <span class="pull-right badge badge-info">+11</span>
                                </div>
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="dropdown-footer">
                    <a href="#">
                        See all notifications
                        <i class="ace-icon fa fa-arrow-right"></i>
                    </a>
                </li>
            </ul>
        </li>-->

        <#--<li class="green dropdown-modal">
            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                <i class="ace-icon fa fa-envelope icon-animated-vertical"></i>
                <span class="badge badge-success">5</span>
            </a>

            <ul class="dropdown-menu-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close">
                <li class="dropdown-header">
                    <i class="ace-icon fa fa-envelope-o"></i>
                    5 Messages
                </li>

                <li class="dropdown-content">
                    <ul class="dropdown-menu dropdown-navbar">
                        <li>
                            <a href="#" class="clearfix">
                                <img src="/assets/images/avatars/avatar.png" class="msg-photo" alt="Alex's Avatar" />
                                <span class="msg-body">
                                                        <span class="msg-title">
                                                            <span class="blue">Alex:</span>
                                                            Ciao sociis natoque penatibus et auctor ...
                                                        </span>

                                                        <span class="msg-time">
                                                            <i class="ace-icon fa fa-clock-o"></i>
                                                            <span>a moment ago</span>
                                                        </span>
                                                    </span>
                            </a>
                        </li>

                        <li>
                            <a href="#" class="clearfix">
                                <img src="/assets/images/avatars/avatar3.png" class="msg-photo" alt="Susan's Avatar" />
                                <span class="msg-body">
                                                        <span class="msg-title">
                                                            <span class="blue">Susan:</span>
                                                            Vestibulum id ligula porta felis euismod ...
                                                        </span>

                                                        <span class="msg-time">
                                                            <i class="ace-icon fa fa-clock-o"></i>
                                                            <span>20 minutes ago</span>
                                                        </span>
                                                    </span>
                            </a>
                        </li>

                        <li>
                            <a href="#" class="clearfix">
                                <img src="/assets/images/avatars/avatar4.png" class="msg-photo" alt="Bob's Avatar" />
                                <span class="msg-body">
                                                        <span class="msg-title">
                                                            <span class="blue">Bob:</span>
                                                            Nullam quis risus eget urna mollis ornare ...
                                                        </span>

                                                        <span class="msg-time">
                                                            <i class="ace-icon fa fa-clock-o"></i>
                                                            <span>3:15 pm</span>
                                                        </span>
                                                    </span>
                            </a>
                        </li>

                        <li>
                            <a href="#" class="clearfix">
                                <img src="/assets/images/avatars/avatar2.png" class="msg-photo" alt="Kate's Avatar" />
                                <span class="msg-body">
                                                        <span class="msg-title">
                                                            <span class="blue">Kate:</span>
                                                            Ciao sociis natoque eget urna mollis ornare ...
                                                        </span>

                                                        <span class="msg-time">
                                                            <i class="ace-icon fa fa-clock-o"></i>
                                                            <span>1:33 pm</span>
                                                        </span>
                                                    </span>
                            </a>
                        </li>

                        <li>
                            <a href="#" class="clearfix">
                                <img src="/assets/images/avatars/avatar5.png" class="msg-photo" alt="Fred's Avatar" />
                                <span class="msg-body">
                                                        <span class="msg-title">
                                                            <span class="blue">Fred:</span>
                                                            Vestibulum id penatibus et auctor  ...
                                                        </span>

                                                        <span class="msg-time">
                                                            <i class="ace-icon fa fa-clock-o"></i>
                                                            <span>10:09 am</span>
                                                        </span>
                                                    </span>
                            </a>
                        </li>
                    </ul>
                </li>

                <li class="dropdown-footer">
                    <a href="inbox.html">
                        See all messages
                        <i class="ace-icon fa fa-arrow-right"></i>
                    </a>
                </li>
            </ul>
        </li>-->

        <li class="light-blue dropdown-modal">
            <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                <img class="nav-user-photo" src="/assets/images/avatars/user.jpg" alt="Jason's Photo" />
                <span class="user-info">
                    <small>欢迎您！</small>
                    <@shiro.user>
                        <@shiro.principal property="userName"/>
                    </@shiro.user>
                </span>

                <i class="ace-icon fa fa-caret-down"></i>
            </a>

            <ul class="user-menu dropdown-menu-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
                <li>
                    <a href="#" data-toggle="modal" data-target="#plan-modal">
                        <i class="ace-icon fa fa-cog"></i>
                        修改密码
                    </a>
                </li>

            <#--<li>
                <a href="profile.html">
                    <i class="ace-icon fa fa-user"></i>
                    Profile
                </a>
            </li>-->

                <li class="divider"></li>

                <li>
                    <a id="logoutButton" href="#">
                        <i class="ace-icon fa fa-power-off"></i>
                        退出
                    </a>
                </li>
            </ul>
        </li>
    </ul>
    <div id="plan-modal" class="modal fade " tabindex="-1" role="dialog" data-backdrop="static">
        <div class="modal-dialog">
            <div id="plan-content" class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h3 class="smaller lighter blue no-margin">修改密码</h3>
                </div>
                <div class="modal-body">
                    <div class="profile-user-info profile-user-info-striped">
                        <div class="profile-info-row">
                            <div class="profile-info-name"><span style="color:red;">*</span> 新密码 </div>
                            <div class="profile-info-value">
                                <input id="password" type="password" name="password" placeholder="请输入新密码"/>
                                &nbsp;&nbsp;<span id="passwordMsg" style="color: red;"></span>
                            </div>
                        </div>
                        <div class="profile-info-row">
                            <div class="profile-info-name"><span style="color:red;">*</span> 确认新密码 </div>
                            <div class="profile-info-value">
                                <input id="againPassword" type="password" name="againPassword" placeholder="请再次输入新密码"/>
                                &nbsp;&nbsp;<span id="againPasswordMsg" style="color: red;"></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="space visible-xs"></div>
                <div class="modal-footer">
                    <button id="confrimButton" class="btn btn-sm btn-success pull-right" onclick="confrim()">
                        <i class="ace-icon fa fa-check"></i>
                        确定
                    </button>
                    <button class="btn btn-sm btn-danger pull-right" data-dismiss="modal">
                        <i class="ace-icon fa fa-times"></i>
                        关闭
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function confrim(){
        if($("#password").val()==""){
            $("#passwordMsg").html("新密码不能为空！").show(300).delay(3000).hide(300);
            return;
        }
        if($("#againPassword").val()==""){
            $("#againPasswordMsg").html("确认新密码不能为空！").show(300).delay(3000).hide(300);
            return;
        }
        if($("#password").val()!=$("#againPassword").val()){
            $("#againPasswordMsg").html("两次输入密码不一致！").show(300).delay(3000).hide(300);
            return;
        }
        var id = '<@shiro.principal property="id"/>';
        var loginId = '<@shiro.principal property="loginId"/>';
        var password = $("#password").val();
        $.ajax({
            url: "/system/users/resetpassword",
            type: "POST",
            contentType: "application/x-www-form-urlencoded",
            data : {"id":id , "loginId":loginId , "password":password},
            dataType: "json",
            timeout: 10000,
            success: function (data) {
                if(data.sysCode==0){
                    if(data.bizCode==0){
                        $('#plan-modal').modal('hide')
                    }
                }
            },
            fail: function (err) {
                console.log(err)
            }
        });
    }
    jQuery(function($) {
            $("#logoutButton").on("click",function(e){
                $.ajax({
                    url: "/system/logout",
                    type: "GET",
                    contentType: "application/json",
                    data : null,
                    dataType: "json",
                    timeout: 10000,
                    success: function (data) {
                        if(data.sysCode==0){
                            if(data.bizCode==0){
                                window.location.href = "/system/login";
                            }
                        }
                    },
                    fail: function (err) {
                        console.log(err)
                    }
                })
        });
    });

</script>